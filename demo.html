<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MeetingWatch — Demo Homepage</title>
  <meta name="description" content="MeetingWatch demo homepage powered by live meetings.json (GitHub Pages)." />
  <style>
    :root{
      --bg: #0b1220;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.085);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --faint: rgba(255,255,255,.56);
      --line: rgba(255,255,255,.14);
      --brand: #7dd3fc;     /* sky-300 */
      --brand2:#a78bfa;     /* violet-400 */
      --good: #34d399;      /* emerald-400 */
      --warn: #fbbf24;      /* amber-400 */
      --bad:  #fb7185;      /* rose-400 */
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 24px;
      --maxw: 1200px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(125,211,252,.18), transparent 60%),
        radial-gradient(900px 600px at 85% 20%, rgba(167,139,250,.16), transparent 55%),
        radial-gradient(900px 650px at 50% 95%, rgba(52,211,153,.12), transparent 55%),
        linear-gradient(180deg, #070b13, var(--bg));
      overflow-x:hidden;
    }

    a{ color: inherit; text-decoration: none; }
    a:hover{ text-decoration: underline; text-underline-offset: 3px; }
    .container{ width: min(var(--maxw), calc(100% - 40px)); margin: 0 auto; }
    .row{ display:flex; gap:18px; }
    .grid{ display:grid; gap:18px; }
    .hidden{ display:none !important; }

    /* Top bar */
    .topbar{
      position: sticky;
      top:0;
      z-index: 50;
      backdrop-filter: blur(14px);
      background: rgba(9, 12, 20, .68);
      border-bottom: 1px solid var(--line);
    }
    .topbar-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 12px 0;
      gap: 12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 220px;
    }
    .logo{
      width: 34px; height: 34px;
      border-radius: 12px;
      background:
        radial-gradient(12px 12px at 30% 35%, rgba(255,255,255,.9), transparent 55%),
        radial-gradient(30px 30px at 70% 70%, rgba(255,255,255,.2), transparent 60%),
        linear-gradient(135deg, rgba(125,211,252,.95), rgba(167,139,250,.95));
      box-shadow: 0 10px 35px rgba(125,211,252,.12);
      border: 1px solid rgba(255,255,255,.25);
    }
    .brand h1{
      font-size: 14px;
      margin:0;
      letter-spacing:.2px;
      line-height: 1.1;
    }
    .brand .sub{
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
      letter-spacing:.15px;
    }
    .pillrow{
      display:flex;
      align-items:center;
      flex-wrap:wrap;
      gap: 10px;
      justify-content:flex-end;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }
    .dot{
      width:8px; height:8px;
      border-radius: 999px;
      background: var(--warn);
      box-shadow: 0 0 0 3px rgba(251,191,36,.14);
      flex: 0 0 auto;
    }
    .dot.good{
      background: var(--good);
      box-shadow: 0 0 0 3px rgba(52,211,153,.14);
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-size: 13px;
      cursor:pointer;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      user-select:none;
      text-decoration:none;
    }
    .btn:hover{
      background: rgba(255,255,255,.09);
      border-color: rgba(255,255,255,.22);
      text-decoration:none;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color: rgba(125,211,252,.35);
      background: linear-gradient(135deg, rgba(125,211,252,.18), rgba(167,139,250,.14));
      box-shadow: 0 16px 45px rgba(125,211,252,.10);
    }

    /* Hero */
    .hero{
      padding: 26px 0 10px;
    }
    .hero .wrap{
      border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      border-radius: var(--radius2);
      overflow:hidden;
      position: relative;
    }
    .hero .wrap::before{
      content:"";
      position:absolute;
      inset:-140px -120px auto auto;
      width: 380px; height: 380px;
      border-radius: 999px;
      background: radial-gradient(circle at 40% 40%, rgba(125,211,252,.28), transparent 55%);
      filter: blur(0px);
      pointer-events:none;
    }
    .hero .wrap::after{
      content:"";
      position:absolute;
      inset:auto auto -160px -160px;
      width: 420px; height: 420px;
      border-radius: 999px;
      background: radial-gradient(circle at 50% 50%, rgba(167,139,250,.22), transparent 60%);
      pointer-events:none;
    }

    .hero-inner{
      padding: 26px 22px 18px;
    }
    .kicker{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding: 7px 10px;
      border-radius: 999px;
      width: fit-content;
    }
    .spark{
      width: 10px; height: 10px;
      border-radius: 2px;
      transform: rotate(18deg);
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 8px 24px rgba(167,139,250,.18);
    }
    .hero h2{
      margin: 14px 0 10px;
      font-size: clamp(24px, 3.6vw, 42px);
      line-height: 1.08;
      letter-spacing: -.5px;
    }
    .hero p{
      margin: 0 0 16px;
      max-width: 76ch;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.6;
    }
    .hero-actions{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      align-items:center;
      margin-top: 6px;
    }

    /* Stats */
    .stats{
      margin-top: 16px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
    }
    .stat{
      grid-column: span 3;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.05);
      padding: 12px 12px;
    }
    .stat .label{
      color: var(--muted);
      font-size: 12px;
      margin-bottom: 8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .stat .value{
      font-size: 22px;
      letter-spacing: -.4px;
      margin:0;
    }
    .stat .hint{
      margin-top: 6px;
      font-size: 12px;
      color: var(--faint);
      line-height: 1.35;
    }
    .badge{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,.78);
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      padding: 2px 8px;
      border-radius: 999px;
      white-space: nowrap;
    }

    /* Main layout */
    .main{
      padding: 18px 0 52px;
    }
    .main-grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .main-grid{ grid-template-columns: 1fr; }
      .stat{ grid-column: span 6; }
    }
    @media (max-width: 620px){
      .stat{ grid-column: span 12; }
    }

    .panel{
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.045);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panel-head{
      padding: 14px 14px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
    }
    .panel-head h3{
      margin:0;
      font-size: 13px;
      letter-spacing: .2px;
      color: rgba(255,255,255,.88);
    }
    .panel-head .meta{
      font-size: 12px;
      color: var(--muted);
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .panel-body{
      padding: 14px;
    }

    /* Controls */
    .controls{
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr 1fr;
      gap: 10px;
      align-items:center;
    }
    @media (max-width: 980px){
      .controls{ grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 620px){
      .controls{ grid-template-columns: 1fr; }
    }

    .field{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 10px 12px;
      display:flex;
      align-items:center;
      gap: 10px;
      min-height: 42px;
    }
    .field label{
      color: var(--faint);
      font-size: 12px;
      white-space: nowrap;
    }
    .field input[type="search"], .field select{
      width: 100%;
      border: 0;
      outline: none;
      background: transparent;
      color: var(--text);
      font-size: 13px;
      font-family: inherit;
    }
    .field select{ appearance:none; }
    .field option{ color:#111; }
    .tog{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
    }
    .chip{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.04);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
      cursor:pointer;
      user-select:none;
    }
    .chip[aria-pressed="true"]{
      border-color: rgba(125,211,252,.34);
      background: linear-gradient(135deg, rgba(125,211,252,.14), rgba(167,139,250,.10));
      color: rgba(255,255,255,.92);
    }

    /* Meetings list */
    .list{
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .card{
      border: 1px solid rgba(255,255,255,.14);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.045);
      overflow:hidden;
    }
    .card-top{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      background: rgba(255,255,255,.03);
    }
    .title{
      display:flex;
      flex-direction:column;
      gap: 6px;
      min-width: 0;
    }
    .title .line1{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      align-items:center;
      font-weight: 650;
      letter-spacing:.15px;
      font-size: 14px;
    }
    .title .line2{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      align-items:center;
      color: var(--muted);
      font-size: 12px;
    }
    .tag{
      font-family: var(--mono);
      font-size: 11px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.05);
      padding: 2px 8px;
      border-radius: 999px;
      color: rgba(255,255,255,.78);
      white-space: nowrap;
    }
    .tag.good{ border-color: rgba(52,211,153,.32); background: rgba(52,211,153,.10); color: rgba(236,253,245,.92); }
    .tag.warn{ border-color: rgba(251,191,36,.32); background: rgba(251,191,36,.10); color: rgba(255,251,235,.92); }
    .tag.bad{ border-color: rgba(251,113,133,.32); background: rgba(251,113,133,.10); color: rgba(255,241,242,.92); }

    .actions{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .mini{
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 12px;
    }
    .card-body{
      padding: 12px 12px 12px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .summary{
      color: rgba(255,255,255,.86);
      font-size: 13px;
      line-height: 1.55;
    }
    .summary ul{
      margin: 0;
      padding-left: 18px;
    }
    .summary li{ margin: 6px 0; color: rgba(255,255,255,.84); }
    .muted{ color: var(--muted); }
    .footnote{ color: var(--faint); font-size: 12px; line-height: 1.45; }

    /* Right column: bars + roadmap + pricing */
    .bars{
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .barrow{
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items:center;
    }
    .barrow .name{
      color: rgba(255,255,255,.86);
      font-size: 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .barwrap{
      grid-column: 1 / -1;
      height: 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      overflow:hidden;
    }
    .bar{
      height:100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(125,211,252,.85), rgba(167,139,250,.85));
    }

    .timeline{
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .milestone{
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      border-radius: var(--radius2);
      padding: 12px;
      position:relative;
      overflow:hidden;
    }
    .milestone::before{
      content:"";
      position:absolute;
      inset: 0 auto 0 0;
      width: 4px;
      background: linear-gradient(180deg, rgba(125,211,252,.9), rgba(167,139,250,.75));
    }
    .milestone h4{
      margin:0 0 6px 0;
      font-size: 13px;
      letter-spacing:.2px;
    }
    .milestone .when{
      color: var(--muted);
      font-size: 12px;
      margin-bottom: 8px;
    }
    .milestone ul{
      margin: 0;
      padding-left: 18px;
      color: rgba(255,255,255,.84);
      font-size: 12.5px;
      line-height: 1.45;
    }
    .milestone li{ margin: 5px 0; }

    .pricing{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    .tier{
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      border-radius: var(--radius2);
      overflow:hidden;
    }
    .tier-head{
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      background: rgba(255,255,255,.03);
    }
    .tier h4{ margin:0; font-size: 13px; }
    .tier .price{
      font-family: var(--mono);
      font-size: 12px;
      color: rgba(255,255,255,.85);
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.05);
      border-radius: 999px;
      padding: 4px 10px;
      white-space: nowrap;
    }
    .tier-body{ padding: 12px; }
    .tier ul{
      margin: 0;
      padding-left: 18px;
      color: rgba(255,255,255,.84);
      font-size: 12.5px;
      line-height: 1.45;
    }
    .tier li{ margin: 5px 0; }
    .tier .aud{
      color: var(--muted);
      font-size: 12px;
      margin-top: 8px;
      line-height: 1.35;
    }

    .footer{
      padding: 18px 0 34px;
      color: var(--faint);
      font-size: 12px;
      text-align:center;
    }
    .hr{
      height:1px;
      background: rgba(255,255,255,.12);
      margin: 18px 0;
    }

    /* Loading skeleton */
    .skeleton{
      border: 1px solid rgba(255,255,255,.14);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.04);
      padding: 12px;
      overflow:hidden;
      position:relative;
      min-height: 70px;
    }
    .skeleton::after{
      content:"";
      position:absolute;
      inset:0;
      transform: translateX(-60%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.08), transparent);
      animation: shimmer 1.3s infinite;
    }
    @keyframes shimmer{
      0%{ transform: translateX(-60%); }
      100%{ transform: translateX(60%); }
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="container topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>MeetingWatch <span class="muted">• Demo</span></h1>
          <div class="sub">Live agenda aggregation + AI summaries</div>
        </div>
      </div>

      <div class="pillrow">
        <div class="pill" title="Data freshness from meetings.json">
          <span id="liveDot" class="dot"></span>
          <span>Live data</span>
          <span id="lastChecked" class="badge">Loading…</span>
        </div>
        <a class="btn mini" href="https://human83.github.io/MeetingWatch/" title="Current production homepage">Current site</a>
        <a class="btn mini" href="https://human83.github.io/MeetingWatch/data/meetings.json" title="Raw data feed (meetings.json)">meetings.json</a>
        <a class="btn primary mini" href="#meetings">Browse meetings</a>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="container">
      <div class="wrap">
        <div class="hero-inner">
          <div class="kicker"><span class="spark"></span>Product vision mockup, powered by your real pipeline</div>
          <h2>Transparency you can search, alert on, and act on.</h2>
          <p>
            This demo pulls the <span class="badge">live</span> MeetingWatch data feed and renders it like a future product:
            dashboards, filters, alerts, and tiered plans — without changing your existing site.
          </p>
          <div class="hero-actions">
            <a class="btn primary" href="#meetings">See upcoming meetings</a>
            <a class="btn" href="#vision">See roadmap + monetization</a>
            <button class="btn" id="btnRefresh" type="button" title="Re-fetch meetings.json">Refresh data</button>
          </div>

          <div class="stats" aria-label="Live summary stats">
            <div class="stat">
              <div class="label"><span>Upcoming meetings</span><span class="badge" id="statRange">All</span></div>
              <p class="value" id="statMeetings">—</p>
              <div class="hint" id="statMeetingsHint">Loading…</div>
            </div>
            <div class="stat">
              <div class="label"><span>Cities covered</span><span class="badge" id="statCitiesBadge">—</span></div>
              <p class="value" id="statCities">—</p>
              <div class="hint">Distinct jurisdictions in this feed</div>
            </div>
            <div class="stat">
              <div class="label"><span>Agendas found</span><span class="badge" id="statAgendaBadge">—</span></div>
              <p class="value" id="statAgendas">—</p>
              <div class="hint">Items with an agenda URL in the feed</div>
            </div>
            <div class="stat">
              <div class="label"><span>Next meeting</span><span class="badge" id="statNextBadge">Soonest</span></div>
              <p class="value" id="statNext">—</p>
              <div class="hint" id="statNextHint">—</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <main class="main">
    <div class="container main-grid">
      <!-- LEFT -->
      <section id="meetings" class="panel">
        <div class="panel-head">
          <h3>Upcoming meetings</h3>
          <div class="meta">
            <span class="badge" id="resultsCount">— results</span>
            <span class="badge" id="citiesCount">— cities</span>
          </div>
        </div>

        <div class="panel-body">
          <div class="controls" aria-label="Filters">
            <div class="field">
              <label for="q">Search</label>
              <input id="q" type="search" placeholder="Try: zoning, annexation, budget, ordinance…" autocomplete="off" />
            </div>
            <div class="field">
              <label for="city">City</label>
              <select id="city">
                <option value="">All</option>
              </select>
            </div>
            <div class="field">
              <label for="source">Source</label>
              <select id="source">
                <option value="">All</option>
              </select>
            </div>
            <div class="field">
              <label for="sort">Sort</label>
              <select id="sort">
                <option value="date_asc">Soonest</option>
                <option value="date_desc">Latest</option>
                <option value="city_asc">City (A→Z)</option>
              </select>
            </div>
          </div>

          <div class="tog" aria-label="Quick filters">
            <button class="chip" id="chipAll" aria-pressed="true" type="button" data-range="all">All</button>
            <button class="chip" id="chip7" aria-pressed="false" type="button" data-range="7">Next 7 days</button>
            <button class="chip" id="chip30" aria-pressed="false" type="button" data-range="30">Next 30 days</button>
            <button class="chip" id="chipAgenda" aria-pressed="false" type="button" data-flag="agenda">Only with agenda</button>
            <button class="chip" id="chipSummaries" aria-pressed="false" type="button" data-flag="summary">Only with summary</button>
            <button class="chip" id="chipReset" aria-pressed="false" type="button" title="Reset all filters">Reset</button>
          </div>

          <div class="hr"></div>

          <div id="list" class="list" aria-live="polite">
            <div class="skeleton"></div>
            <div class="skeleton"></div>
            <div class="skeleton"></div>
          </div>

          <div id="empty" class="hidden" style="margin-top:12px;">
            <div class="card">
              <div class="card-body">
                <div class="summary">
                  <strong>No matches.</strong>
                  <div class="muted" style="margin-top:6px;">
                    Try clearing a filter, or broaden your search.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="error" class="hidden" style="margin-top:12px;">
            <div class="card">
              <div class="card-body">
                <div class="summary">
                  <strong>Couldn’t load the live feed.</strong>
                  <div class="muted" style="margin-top:6px;">
                    If you opened this file directly (file://), your browser may block fetch().
                    Host it on GitHub Pages (or run a local server) and reload.
                  </div>
                  <div class="footnote" id="errorMsg" style="margin-top:10px;"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="hr"></div>
          <div class="footnote">
            Demo notes: This is a <strong>single-file</strong> page that fetches live data from
            <span class="badge">/data/meetings.json</span>. Some sources may not provide an agenda link yet —
            in those cases the “Details” link points to the source’s meeting files page (when available).
          </div>
        </div>
      </section>

      <!-- RIGHT -->
      <aside class="grid" style="gap:18px;">
        <section class="panel">
          <div class="panel-head">
            <h3>Coverage snapshot</h3>
            <div class="meta"><span class="badge">By city</span></div>
          </div>
          <div class="panel-body">
            <div class="bars" id="barsCities">
              <div class="skeleton"></div>
              <div class="skeleton"></div>
            </div>

            <div class="hr"></div>

            <div class="panel-head" style="padding:0 0 10px;border:0;background:transparent;">
              <h3 style="padding:0;margin:0;">Sources</h3>
              <div class="meta"><span class="badge">By provider</span></div>
            </div>
            <div class="bars" id="barsProviders"></div>
          </div>
        </section>

        <section id="vision" class="panel">
          <div class="panel-head">
            <h3>Roadmap (demo)</h3>
            <div class="meta"><span class="badge">Evolution</span></div>
          </div>
          <div class="panel-body">
            <div class="timeline">
              <div class="milestone">
                <h4>Phase 1 — Solidify the foundation</h4>
                <div class="when">Now → ~6 months</div>
                <ul>
                  <li>Expand coverage across a focused region (build a loyal user base).</li>
                  <li>Harden scraping and introduce basic user accounts + keyword alerts.</li>
                  <li>Start decoupling frontend/data with an internal API (future-proofing).</li>
                </ul>
              </div>
              <div class="milestone">
                <h4>Phase 2 — Premium features</h4>
                <div class="when">~6 → 18 months</div>
                <ul>
                  <li>Historical archives + advanced search (minutes, past agendas).</li>
                  <li>Unlimited jurisdictions/alerts for Pro users.</li>
                  <li>Simple topic dashboards + expansion to a second state.</li>
                </ul>
              </div>
              <div class="milestone">
                <h4>Phase 3 — Enterprise scale</h4>
                <div class="when">18+ months</div>
                <ul>
                  <li>Entity tracking, voting patterns, sentiment on transcripts.</li>
                  <li>Team management, custom reporting, high-throughput API.</li>
                  <li>Distributed cloud infrastructure for national coverage.</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="panel-head">
            <h3>Monetization (demo)</h3>
            <div class="meta"><span class="badge">Freemium</span></div>
          </div>
          <div class="panel-body">
            <div class="pricing">
              <div class="tier">
                <div class="tier-head">
                  <div>
                    <h4>Free (Community)</h4>
                    <div class="aud">Citizens, students, community groups</div>
                  </div>
                  <div class="price">$0</div>
                </div>
                <div class="tier-body">
                  <ul>
                    <li>Current agendas + summaries</li>
                    <li>Limited jurisdictions (example: 3 cities)</li>
                    <li>Limited keyword alerts (example: 5)</li>
                  </ul>
                </div>
              </div>

              <div class="tier">
                <div class="tier-head">
                  <div>
                    <h4>Pro (Professional)</h4>
                    <div class="aud">Journalists, activists, small business</div>
                  </div>
                  <div class="price">~$25 / month</div>
                </div>
                <div class="tier-body">
                  <ul>
                    <li>Unlimited jurisdictions + alerts</li>
                    <li>Historical search (agendas & minutes)</li>
                    <li>Saved searches + weekly digests</li>
                  </ul>
                </div>
              </div>

              <div class="tier">
                <div class="tier-head">
                  <div>
                    <h4>Enterprise</h4>
                    <div class="aud">Law/lobbying, corporations, media orgs</div>
                  </div>
                  <div class="price">$200 → $2,000+ / mo</div>
                </div>
                <div class="tier-body">
                  <ul>
                    <li>Team accounts + admin controls</li>
                    <li>Advanced dashboards + reporting</li>
                    <li>API access (metered / usage-based)</li>
                    <li>Priority support</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="hr"></div>
            <div class="footnote">
              This section is <em>visual brainstorming UI</em>. The demo is still powered purely by the existing
              <span class="badge">meetings.json</span> feed — no auth, billing, or backend required yet.
            </div>
          </div>
        </section>
      </aside>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="hr"></div>
      Built as a single-file demo page for brainstorming •
      <span class="badge">demo.html</span> •
      Data source: <a href="https://human83.github.io/MeetingWatch/data/meetings.json">MeetingWatch/data/meetings.json</a>
    </div>
  </footer>

  <script>
    (function(){
      "use strict";

      // --- Configuration ---
      const FEED_URL = "https://human83.github.io/MeetingWatch/data/meetings.json";

      // --- DOM ---
      const el = (id) => document.getElementById(id);

      const lastChecked = el("lastChecked");
      const liveDot = el("liveDot");

      const statMeetings = el("statMeetings");
      const statMeetingsHint = el("statMeetingsHint");
      const statCities = el("statCities");
      const statCitiesBadge = el("statCitiesBadge");
      const statAgendas = el("statAgendas");
      const statAgendaBadge = el("statAgendaBadge");
      const statNext = el("statNext");
      const statNextHint = el("statNextHint");
      const statRange = el("statRange");

      const resultsCount = el("resultsCount");
      const citiesCount = el("citiesCount");
      const list = el("list");
      const empty = el("empty");
      const error = el("error");
      const errorMsg = el("errorMsg");

      const q = el("q");
      const citySel = el("city");
      const sourceSel = el("source");
      const sortSel = el("sort");

      const btnRefresh = el("btnRefresh");

      const chipAll = el("chipAll");
      const chip7 = el("chip7");
      const chip30 = el("chip30");
      const chipAgenda = el("chipAgenda");
      const chipSummaries = el("chipSummaries");
      const chipReset = el("chipReset");

      const barsCities = el("barsCities");
      const barsProviders = el("barsProviders");

      // --- State ---
      let raw = null;
      let meetings = [];
      let filters = {
        q: "",
        city: "",
        source: "",
        sort: "date_asc",
        rangeDays: "all",  // "all" | "7" | "30"
        onlyAgenda: false,
        onlySummary: false
      };

      // --- Helpers ---
      function safeText(v){
        if(v === null || v === undefined) return "";
        return String(v);
      }

      function normalizeSpaces(s){
        return safeText(s).replace(/\\s+/g, " ").trim();
      }

      function parseDateOnlyYYYYMMDD(dateStr){
        // dateStr like "2026-01-27"
        const m = /^\\s*(\\d{4})-(\\d{2})-(\\d{2})\\s*$/.exec(safeText(dateStr));
        if(!m) return null;
        const y = Number(m[1]), mo = Number(m[2]), d = Number(m[3]);
        // Create at noon local to avoid DST edge weirdness
        return new Date(y, mo - 1, d, 12, 0, 0, 0);
      }

      function parseStartTimeToMinutes(s){
        // Accept "9:00 AM", "07:00 PM", "7:00 PM", maybe null
        s = normalizeSpaces(s);
        if(!s) return null;
        // Handle "HH:MM AM/PM"
        const m = /^(\\d{1,2})(?::(\\d{2}))?\\s*(AM|PM)$/i.exec(s);
        if(!m) return null;
        let hh = Number(m[1]);
        const mm = Number(m[2] || "0");
        const ap = m[3].toUpperCase();
        if(ap === "PM" && hh !== 12) hh += 12;
        if(ap === "AM" && hh === 12) hh = 0;
        return hh * 60 + mm;
      }

      function dateKey(d){
        // YYYY-MM-DD for a Date object
        const y = d.getFullYear();
        const m = String(d.getMonth()+1).padStart(2, "0");
        const day = String(d.getDate()).padStart(2, "0");
        return `${y}-${m}-${day}`;
      }

      function fmtHumanDate(dateStr){
        const d = parseDateOnlyYYYYMMDD(dateStr);
        if(!d) return safeText(dateStr);
        return d.toLocaleDateString(undefined, { weekday:"short", year:"numeric", month:"short", day:"numeric" });
      }

      function isWithinDays(dateStr, days){
        if(days === "all") return true;
        const d = parseDateOnlyYYYYMMDD(dateStr);
        if(!d) return true;
        const now = new Date();
        const start = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0,0,0,0);
        const end = new Date(start.getTime() + Number(days) * 24*60*60*1000);
        return d >= start && d <= end;
      }

      function hasAgenda(m){
        return !!normalizeSpaces(m.agenda_url);
      }

      function hasSummary(m){
        return Array.isArray(m.agenda_summary) && m.agenda_summary.length > 0;
      }

      function deriveSourceLabel(m){
        // Prefer provider when present; fall back to hostname from source URL
        const prov = normalizeSpaces(m.provider);
        if(prov) return prov;
        const src = normalizeSpaces(m.source);
        if(!src) return "Unknown";
        try{
          const u = new URL(src);
          // Keep short-ish: "legistar.com" -> "legistar"
          return u.hostname.replace(/^www\\./,"");
        }catch(_){
          return "Unknown";
        }
      }

      function cleanMeetingType(m){
        // Some sources return long run-on strings. Try to extract a readable tail.
        let t = normalizeSpaces(m.meeting_type);
        if(!t) t = normalizeSpaces(m.body) || "Meeting";
        // Common endings we care about
        const candidates = [
          "City Council Regular Meeting",
          "City Council Meeting",
          "City Council Work Session",
          "Work Session",
          "Regular Meeting",
          "Special Meeting",
          "Board of County Commissioners",
          "Board of County Commissioners Meeting"
        ];
        for(const c of candidates){
          if(t.includes(c)) return c;
        }

        // CivicClerk run-on: try to pull the last "Meeting" phrase
        const idx = t.lastIndexOf("Meeting");
        if(idx > 10){
          const tail = t.slice(Math.max(0, idx - 30), idx + "Meeting".length);
          // If tail has "Council" or "Commission" etc, use a bit more
          const j = t.lastIndexOf("City Council", idx);
          if(j >= 0) return normalizeSpaces(t.slice(j, Math.min(t.length, j + 40)));
          return normalizeSpaces(t.slice(Math.max(0, idx - 20), Math.min(t.length, idx + 20)));
        }

        // Fallback: cap
        if(t.length > 64) return t.slice(0, 61) + "…";
        return t || "Meeting";
      }

      function computeSortableMoment(m){
        // Use date + time when available. Otherwise date only.
        const d = parseDateOnlyYYYYMMDD(m.date);
        if(!d) return Number.POSITIVE_INFINITY;
        const mins = parseStartTimeToMinutes(m.start_time_local);
        if(mins !== null){
          const hh = Math.floor(mins/60);
          const mm = mins%60;
          d.setHours(hh, mm, 0, 0);
        }
        return d.getTime();
      }

      function escHtml(s){
        return safeText(s)
          .replace(/&/g,"&amp;")
          .replace(/</g,"&lt;")
          .replace(/>/g,"&gt;")
          .replace(/"/g,"&quot;")
          .replace(/'/g,"&#039;");
      }

      function setChip(chip, on){
        chip.setAttribute("aria-pressed", on ? "true" : "false");
      }

      function pickRangeChip(days){
        setChip(chipAll, days === "all");
        setChip(chip7, days === "7");
        setChip(chip30, days === "30");
      }

      // --- Render ---
      function renderBars(container, entries, total){
        // entries: [{name, count}]
        container.innerHTML = "";
        const max = Math.max(1, ...entries.map(e => e.count));
        for(const e of entries){
          const pct = Math.round((e.count / max) * 100);
          const row = document.createElement("div");
          row.className = "barrow";
          row.innerHTML = `
            <div class="name">
              <span>${escHtml(e.name)}</span>
              <span class="badge">${e.count}</span>
            </div>
            <div class="barwrap" aria-hidden="true"><div class="bar" style="width:${pct}%"></div></div>
          `;
          container.appendChild(row);
        }
        if(entries.length === 0){
          container.innerHTML = `<div class="footnote">No data</div>`;
        }
      }

      function renderStats(view){
        const total = view.length;
        const cities = new Set(view.map(m => normalizeSpaces(m.city) || "Unknown"));
        const agendaCount = view.filter(hasAgenda).length;
        const summaryCount = view.filter(hasSummary).length;

        statMeetings.textContent = String(total);
        statMeetingsHint.textContent = `${agendaCount} with agendas • ${summaryCount} with summaries`;

        statCities.textContent = String(cities.size);
        statCitiesBadge.textContent = `${cities.size}`;

        statAgendas.textContent = `${agendaCount}`;
        statAgendaBadge.textContent = `${Math.round((agendaCount / Math.max(1,total)) * 100)}%`;

        // Next meeting (soonest overall from full feed, not filtered by text query)
        const sorted = [...view].sort((a,b)=> computeSortableMoment(a) - computeSortableMoment(b));
        const next = sorted[0];
        if(next){
          statNext.textContent = `${normalizeSpaces(next.city) || "Unknown"}`;
          statNextHint.textContent = `${fmtHumanDate(next.date)} • ${normalizeSpaces(next.start_time_local) || "Time TBA"} • ${cleanMeetingType(next)}`;
        }else{
          statNext.textContent = "—";
          statNextHint.textContent = "—";
        }
      }

      function renderList(view){
        list.innerHTML = "";
        empty.classList.add("hidden");

        if(view.length === 0){
          empty.classList.remove("hidden");
          resultsCount.textContent = "0 results";
          citiesCount.textContent = "0 cities";
          return;
        }

        const citySet = new Set(view.map(m => normalizeSpaces(m.city) || "Unknown"));
        resultsCount.textContent = `${view.length} results`;
        citiesCount.textContent = `${citySet.size} cities`;

        for(const m of view){
          const city = normalizeSpaces(m.city) || "Unknown";
          const body = normalizeSpaces(m.body);
          const type = cleanMeetingType(m);
          const when = fmtHumanDate(m.date);
          const time = normalizeSpaces(m.start_time_local) || "Time TBA";
          const status = normalizeSpaces(m.status) || "Scheduled";
          const loc = normalizeSpaces(m.location);
          const agendaUrl = normalizeSpaces(m.agenda_url);
          const src = normalizeSpaces(m.source);
          const details = normalizeSpaces(m.url); // some providers include url to meeting page/files

          const provider = deriveSourceLabel(m);

          const summary = Array.isArray(m.agenda_summary) ? m.agenda_summary : [];
          const summaryShort = summary.slice(0, 6);
          const hasMore = summary.length > summaryShort.length;

          const tagAgenda = hasAgenda(m) ? `<span class="tag good">Agenda</span>` : `<span class="tag warn">No agenda</span>`;
          const tagSummary = hasSummary(m) ? `<span class="tag good">Summary</span>` : `<span class="tag">No summary</span>`;

          const card = document.createElement("article");
          card.className = "card";
          card.innerHTML = `
            <div class="card-top">
              <div class="title">
                <div class="line1">
                  <span>${escHtml(city)}</span>
                  <span class="tag">${escHtml(type)}</span>
                  ${body ? `<span class="tag">${escHtml(body)}</span>` : ``}
                </div>
                <div class="line2">
                  <span class="tag">${escHtml(when)}</span>
                  <span class="tag">${escHtml(time)}</span>
                  <span class="tag">${escHtml(status)}</span>
                  <span class="tag">${escHtml(provider)}</span>
                  ${loc ? `<span class="tag" title="${escHtml(loc)}">Location</span>` : ``}
                </div>
              </div>

              <div class="actions">
                ${tagAgenda}
                ${tagSummary}
                ${agendaUrl ? `<a class="btn mini" href="${escHtml(agendaUrl)}" target="_blank" rel="noopener">Agenda</a>` : ``}
                ${details ? `<a class="btn mini" href="${escHtml(details)}" target="_blank" rel="noopener">Details</a>` : ``}
                ${src ? `<a class="btn mini" href="${escHtml(src)}" target="_blank" rel="noopener">Source</a>` : ``}
              </div>
            </div>

            <div class="card-body">
              <div class="summary">
                ${
                  summaryShort.length
                    ? `<ul>${summaryShort.map(x => `<li>${escHtml(normalizeSpaces(x))}</li>`).join("")}</ul>`
                    : `<div class="muted">No summary yet for this meeting in the current feed.</div>`
                }
                ${
                  hasMore
                    ? `<div style="margin-top:10px;">
                         <button class="btn mini" type="button" data-action="expand">Show all ${summary.length} bullets</button>
                       </div>`
                    : ``
                }
              </div>
              <div class="footnote">
                ${agendaUrl ? `Agenda summary source: <span class="badge">${escHtml(normalizeSpaces(m.agenda_summary_source || "")) || "—"}</span>` : ``}
              </div>
            </div>
          `;

          // Expand/collapse summary
          if(hasMore){
            const btn = card.querySelector('button[data-action="expand"]');
            btn.addEventListener("click", () => {
              const ul = card.querySelector(".summary ul");
              if(!ul) return;
              ul.innerHTML = summary.map(x => `<li>${escHtml(normalizeSpaces(x))}</li>`).join("");
              btn.remove();
            });
          }

          list.appendChild(card);
        }
      }

      function getFilteredView(){
        let view = meetings.slice();

        // range days
        view = view.filter(m => isWithinDays(m.date, filters.rangeDays));

        // only with agenda / summary
        if(filters.onlyAgenda) view = view.filter(hasAgenda);
        if(filters.onlySummary) view = view.filter(hasSummary);

        // city/source
        if(filters.city) view = view.filter(m => normalizeSpaces(m.city) === filters.city);
        if(filters.source) view = view.filter(m => deriveSourceLabel(m) === filters.source);

        // text query
        const term = normalizeSpaces(filters.q).toLowerCase();
        if(term){
          view = view.filter(m => {
            const hay = [
              m.city,
              m.body,
              m.city_or_body,
              m.meeting_type,
              m.status,
              m.location,
              deriveSourceLabel(m),
              ...(Array.isArray(m.agenda_summary) ? m.agenda_summary : [])
            ].map(normalizeSpaces).join(" • ").toLowerCase();
            return hay.includes(term);
          });
        }

        // sort
        if(filters.sort === "date_asc"){
          view.sort((a,b)=> computeSortableMoment(a) - computeSortableMoment(b));
        }else if(filters.sort === "date_desc"){
          view.sort((a,b)=> computeSortableMoment(b) - computeSortableMoment(a));
        }else if(filters.sort === "city_asc"){
          view.sort((a,b)=> normalizeSpaces(a.city).localeCompare(normalizeSpaces(b.city)) || (computeSortableMoment(a)-computeSortableMoment(b)));
        }

        return view;
      }

      function renderAll(){
        const view = getFilteredView();
        renderStats(view);
        renderList(view);

        // range badge
        statRange.textContent = filters.rangeDays === "all" ? "All" : `${filters.rangeDays}d`;

        // coverage bars based on FULL feed (not filtered), but could be filtered if desired
        const countsByCity = {};
        const countsByProv = {};
        for(const m of meetings){
          const c = normalizeSpaces(m.city) || "Unknown";
          const p = deriveSourceLabel(m);
          countsByCity[c] = (countsByCity[c] || 0) + 1;
          countsByProv[p] = (countsByProv[p] || 0) + 1;
        }
        const topCities = Object.entries(countsByCity)
          .map(([name, count]) => ({name, count}))
          .sort((a,b)=> b.count - a.count)
          .slice(0, 6);

        const topProv = Object.entries(countsByProv)
          .map(([name, count]) => ({name, count}))
          .sort((a,b)=> b.count - a.count)
          .slice(0, 6);

        renderBars(barsCities, topCities, meetings.length);
        renderBars(barsProviders, topProv, meetings.length);

        // header badges
        const citySet = new Set(view.map(m => normalizeSpaces(m.city) || "Unknown"));
        resultsCount.textContent = `${view.length} results`;
        citiesCount.textContent = `${citySet.size} cities`;
      }

      function fillSelects(){
        // Cities / sources from full feed
        const citySet = new Set(meetings.map(m => normalizeSpaces(m.city)).filter(Boolean));
        const sources = new Set(meetings.map(m => deriveSourceLabel(m)).filter(Boolean));

        const cities = Array.from(citySet).sort((a,b)=> a.localeCompare(b));
        const srcs = Array.from(sources).sort((a,b)=> a.localeCompare(b));

        // Preserve selection if possible
        const prevCity = citySel.value;
        const prevSrc = sourceSel.value;

        citySel.innerHTML = `<option value="">All</option>` + cities.map(c => `<option value="${escHtml(c)}">${escHtml(c)}</option>`).join("");
        sourceSel.innerHTML = `<option value="">All</option>` + srcs.map(s => `<option value="${escHtml(s)}">${escHtml(s)}</option>`).join("");

        if(prevCity && cities.includes(prevCity)) citySel.value = prevCity;
        if(prevSrc && srcs.includes(prevSrc)) sourceSel.value = prevSrc;
      }

      function setFreshnessIndicator(lastCheckedStr){
        lastChecked.textContent = lastCheckedStr || "—";
        // If within last 12 hours, mark green
        try{
          // Format in feed appears like "YYYY-MM-DD HH:MM"
          const m = /^(\\d{4})-(\\d{2})-(\\d{2})\\s+(\\d{2}):(\\d{2})/.exec(lastCheckedStr || "");
          if(m){
            const d = new Date(Number(m[1]), Number(m[2])-1, Number(m[3]), Number(m[4]), Number(m[5]), 0, 0);
            const ageMs = Date.now() - d.getTime();
            const twelveH = 12*60*60*1000;
            liveDot.classList.toggle("good", ageMs >= 0 && ageMs <= twelveH);
          }else{
            liveDot.classList.remove("good");
          }
        }catch(_){
          liveDot.classList.remove("good");
        }
      }

      async function load(){
        error.classList.add("hidden");
        empty.classList.add("hidden");
        list.innerHTML = `<div class="skeleton"></div><div class="skeleton"></div><div class="skeleton"></div>`;

        try{
          // cache buster for GitHub Pages caching
          const url = FEED_URL + (FEED_URL.includes("?") ? "&" : "?") + "v=" + Date.now();
          const res = await fetch(url, { cache: "no-store" });
          if(!res.ok) throw new Error(`HTTP ${res.status} ${res.statusText}`);
          raw = await res.json();

          const last = normalizeSpaces(raw.last_checked_mt);
          setFreshnessIndicator(last);

          meetings = Array.isArray(raw.meetings) ? raw.meetings : [];
          // Defensive normalization to avoid runtime errors
          meetings = meetings.map(m => ({
            city: m.city ?? "",
            body: m.body ?? "",
            city_or_body: m.city_or_body ?? "",
            meeting_type: m.meeting_type ?? "",
            date: m.date ?? "",
            start_time_local: m.start_time_local ?? "",
            status: m.status ?? "",
            location: m.location ?? "",
            agenda_url: m.agenda_url ?? "",
            agenda_summary: Array.isArray(m.agenda_summary) ? m.agenda_summary : [],
            agenda_summary_source: m.agenda_summary_source ?? "",
            source: m.source ?? "",
            provider: m.provider ?? "",
            tz: m.tz ?? "",
            url: m.url ?? ""
          }));

          fillSelects();
          renderAll();

        }catch(e){
          console.error(e);
          error.classList.remove("hidden");
          errorMsg.textContent = String(e && e.message ? e.message : e);
          list.innerHTML = "";
          resultsCount.textContent = "— results";
          citiesCount.textContent = "— cities";
          statMeetings.textContent = "—";
          statCities.textContent = "—";
          statAgendas.textContent = "—";
          statNext.textContent = "—";
          statMeetingsHint.textContent = "Unable to load feed";
          statNextHint.textContent = "—";
          setFreshnessIndicator("");
        }
      }

      // --- Events ---
      q.addEventListener("input", () => { filters.q = q.value; renderAll(); });
      citySel.addEventListener("change", () => { filters.city = citySel.value; renderAll(); });
      sourceSel.addEventListener("change", () => { filters.source = sourceSel.value; renderAll(); });
      sortSel.addEventListener("change", () => { filters.sort = sortSel.value; renderAll(); });

      function resetAll(){
        filters = {
          q: "",
          city: "",
          source: "",
          sort: "date_asc",
          rangeDays: "all",
          onlyAgenda: false,
          onlySummary: false
        };
        q.value = "";
        citySel.value = "";
        sourceSel.value = "";
        sortSel.value = "date_asc";
        pickRangeChip("all");
        setChip(chipAgenda, false);
        setChip(chipSummaries, false);
        renderAll();
      }

      chipAll.addEventListener("click", () => {
        filters.rangeDays = "all";
        pickRangeChip("all");
        renderAll();
      });
      chip7.addEventListener("click", () => {
        filters.rangeDays = "7";
        pickRangeChip("7");
        renderAll();
      });
      chip30.addEventListener("click", () => {
        filters.rangeDays = "30";
        pickRangeChip("30");
        renderAll();
      });

      chipAgenda.addEventListener("click", () => {
        filters.onlyAgenda = !filters.onlyAgenda;
        setChip(chipAgenda, filters.onlyAgenda);
        renderAll();
      });

      chipSummaries.addEventListener("click", () => {
        filters.onlySummary = !filters.onlySummary;
        setChip(chipSummaries, filters.onlySummary);
        renderAll();
      });

      chipReset.addEventListener("click", () => resetAll());

      btnRefresh.addEventListener("click", () => load());

      // Boot
      load();
    })();
  </script>
</body>
</html>
